# 🕵️‍♂️ Web Information Gathering & Advanced Fuzzing

## 📘 Introduction

The **Information Gathering** phase is the first and one of the most critical steps in web application penetration testing. The goal is to collect as much information as possible about the target — without (passive) or with (active) interaction. This helps identify technologies, entry points, and potential vulnerabilities.  

Advanced fuzzing builds on this by systematically detecting hidden subdomains, files, directories, parameters, and more.

---

## 🔹 Types of Information Gathering

### 1. Passive Information Gathering

Passive reconnaissance involves collecting data without directly interacting with the target. It’s stealthy and helps avoid detection.

#### 🔧 Tools and Techniques:

- **Whois**
  ```bash
  whois example.com
  ```
- **DNS Enumeration**
  ```bash
  nslookup example.com
  dig example.com any
  host -a example.com
  ```
- **Google Dorking**
  ```
  site:example.com filetype:pdf
  inurl:admin site:example.com
  intitle:index.of site:example.com
  ```
- **Wayback Machine**  
  View historical snapshots: [archive.org/web](https://archive.org/web)
- **bgp.he.net**  
  Find ASN, IP ranges, domains: search `"Company Name"`
- **Shodan / Censys**
  ```bash
  org:"company name"
  hostname:"example.com"
  ssl:"example.com"
  ```
- **theHarvester**
  ```bash
  theHarvester -d example.com -b google
  ```
- **Recon-ng**
  ```bash
  recon-ng
  > marketplace install all
  > use domains-contacts/whois_pocs
  > run
  ```
- **Amass (Intel Mode)**
  ```bash
  amass intel -org "Tesla"
  ```

---

### 2. Active Information Gathering

Active recon involves direct interaction with the target — sending requests, scanning ports, probing services. Can be detected by IDS.

#### 🔧 Tools and Techniques:

- **Nmap**
  ```bash
  nmap -sV -T4 -Pn example.com
  ```
- **WhatWeb / Wappalyzer**
  ```bash
  whatweb example.com
  ```
- **Gobuster / Dirb / FFUF**
  ```bash
  gobuster dir -u https://example.com -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
  ```
- **hakrevdns**
  ```bash
  hakrevdns 192.168.0.0/24
  ```
- **prips**
  ```bash
  prips 192.168.0.0/24 | hakrevdns
  ```
- **SSL/TLS Scanning**
  ```bash
  testssl.sh example.com
  ```
- **WAF Detection (wafw00f)**
  ```bash
  wafw00f https://example.com
  ```

---

## 🔹 Key Information to Collect

- Subdomains and virtual hosts  
- IP ranges and ASNs  
- Web server technologies (Apache, Nginx)  
- Backend languages (PHP, Python, ASP.NET)  
- Frontend frameworks (React, Angular)  
- Login/admin panels  
- Public APIs  
- Hidden files or folders (`.git`, `robots.txt`, `sitemap.xml`)  
- HTTP headers and status codes  
- SSL certificates and security settings  

---

## 🧰 Useful Tools Summary

| Tool              | Purpose                          |
| ----------------- | -------------------------------- |
| `whois`           | Domain registration info         |
| `nslookup/dig`    | DNS record retrieval             |
| `bgp.he.net`      | Find ASN, IP ranges, domains     |
| `Shodan`          | Exposed services & devices       |
| `amass intel`     | Org-wide subdomains & ASNs       |
| `theHarvester`    | OSINT: Emails, subdomains, names |
| `recon-ng`        | Automated OSINT framework        |
| `nmap`            | Port and service enumeration     |
| `hakrevdns`       | Reverse DNS lookups              |
| `prips`           | Generate IP ranges               |
| `gobuster/ffuf`   | Directory/file brute-forcing     |
| `whatweb`         | Detect web technologies          |
| `wafw00f`         | Detect web firewalls             |
| `subfinder`       | Subdomain enumeration            |
| `assetfinder`     | Passive asset discovery          |
| `DNSCan / dnscan` | DNS subdomain enumeration        |

---

## 🔹 Advanced Fuzzing

Advanced fuzzing is used to discover hidden subdomains, files, directories, parameters, and endpoints. Techniques include recursive fuzzing, HTTP method variations (GET, POST, PUT), port fuzzing, header injection, and payload testing for XSS, SQLi, and RCE.

### Tools & Techniques:

- **Subdomain Fuzzing**
  ```bash
  ffuf -u https://FUZZ.example.com -w dnswords.txt
  ffuf -u https://FUZZ.test.example.com -w dnswords.txt
  subfinder -d example.com --recursive -all
  echo "example.com" | assetfinder -subs-only
  python3 dnscan.py -d example.com -w wordlist -t 300
  ```
- **Files & Directories Fuzzing**
  ```bash
  dirsearch -u https://sub.domain.com
  dirsearch -u https://sub.domain.com -m POST
  ffuf -u https://sub.domain.com:port/FUZZ -w wordlist.txt -X POST
  ```
- **Parameter Fuzzing**
  ```bash
  ffuf -u https://example.com/file.php?FUZZ=test -w params.txt
  arjun -u https://example.com/file.php
  arjun -u https://example.com/file.php -m POST
  ```
- **Password Fuzzing**
  ```bash
  ffuf -X POST -u https://example.com/login -d '{"user":"USER","pass":"FUZZ"}' -w passwords.txt
  ```
- **IP Rotation with Tor**
  ```bash
  sudo apt install tor
  nano /etc/tor/torrc
  # Add:
  SocksPort 9050
  SocksPolicy accept *
  
  tmux new -s tor
  while true; do pkill -HUP tor; sleep 1; done
  ```
- **Header Injection & Payloads**  
  Inject XSS, SQLi, RCE payloads in headers while fuzzing directories and parameters.

---

## 🔹 Useful Websites for Subdomain Enumeration

1. [Security Trails](https://securitytrails.com/)  
2. [ShrewdEye](https://www.shrewdeye.com/)  
3. [Subdomain Finder](https://subdomainfinder.c99.nl/)  

---

## 🔹 References

- [Bypass Rate Limit & Request Fuzzing with Tor](https://infosecwriteups.com/bypass-rate-limit-request-fuzzing-etc-with-tor-3a285f3980d2)
