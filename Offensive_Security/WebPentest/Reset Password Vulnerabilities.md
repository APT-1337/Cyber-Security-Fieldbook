# ðŸ”’ Reset Password Vulnerabilities

## 1. Missing Rate Limit

- **Description:** No limit on how many times the reset link can be requested.
    
- **Impact:**
    
    - Email bombing (flooding the victimâ€™s inbox).
        
    - Resource exhaustion (SMTP server overload).
        
    - Increased costs for the service provider.
        
- **Testing:** Send multiple reset requests to the same email. Observe if thereâ€™s blocking, Captcha, or delay.
    

## 2. Token Sent Over HTTP

- **Description:** Reset token is sent via insecure HTTP instead of HTTPS.
    
- **Impact:**
    
    - Man-in-the-Middle (MITM) attack can steal the token.
        
    - Search engines or archives may index the token â†’ account takeover.
        
- **Testing:** Check the reset link in the email. Ensure the URL uses HTTPS.
    

## 3. Exposed Token

- **Description:** Token appears in places other than the email (history, logs, referrer).
    
- **Impact:** Attacker can steal the token and take over the account.
    
- **Testing:** Use BurpSuite to inspect requests and responses. Look for the token in any logs or history.
    

## 4. OTP or Request Exposure

- **Description:** OTP or reset request is visible in request/response.
    
- **Impact:** Allows bypassing authentication â†’ account takeover.
    
- **Testing:** Monitor all responses after requesting reset. Look for sensitive codes.
    

## 5. Improper Session Expiration (Scenario 1)

- **Description:** Request reset link but do not click it â†’ login â†’ change email â†’ then use the old reset link.
    
- **Impact:** Old reset link can still change the password.
    
- **Testing:** Follow the scenario and see if password changes.
    

## 6. Improper Session Expiration (Scenario 2)

- **Description:** Request reset link but do not click â†’ login â†’ change password â†’ then use old reset link.
    
- **Impact:** Old link still works â†’ vulnerability.
    
- **Testing:** Same as above.
    

## 7. Bypass Reset Functionality

- **Description:** Request reset but donâ€™t complete it â†’ directly access `/profile` or `/account`.
    
- **Impact:** Can access protected pages without resetting password.
    
- **Testing:** Modify the URL in Burp to bypass reset flow.
    

## 8. Brute Force OTP

- **Description:** OTP is weak and has no protection.
    
- **Impact:** Can brute-force OTP â†’ account takeover.
    
- **Testing:** Intercept OTP request in Burp, then use Intruder/Turbo Intruder with numeric payloads.
    

## 9. Active Sessions Not Terminated

- **Description:** Old sessions remain active after password change.
    
- **Impact:** Attacker keeps session even after password reset.
    
- **Testing:** Login from multiple browsers, change password in one, check other browser session.
    

## 10. SQL Injection via Reset

- **Description:** Input fields not sanitized.
    
- **Impact:** SQLi â†’ extract data.
    
- **Testing:** Inject `' OR 1=1--` or similar payloads. Export request to file and run SQLMap:
    

```
sqlmap -r request.txt
```

## 11. Hidden Parameters

- **Description:** Reset request may contain hidden parameters.
    
- **Impact:** Can be exploited for bypass or malicious input.
    
- **Testing:**
    

```
arjun -u https://site.com/reset.php -m POST
```

## 12. UUIDv1 Tokens

- **Description:** Reset token uses UUIDv1 (time/MAC based).
    
- **Impact:** Predictable â†’ Sandwich attacks.
    
- **Testing:** Inspect token format, e.g., `70d589f4-93b6-11ef-b864-0242ac120002`.
    

## 13. Token Does Not Expire

- **Description:** Reset link works even after usage or long time.
    
- **Impact:** Reusing link â†’ account takeover.
    
- **Testing:** Use the link multiple times after changing password.
    

## 14. Host Header Injection

- **Description:** Manipulate `Host` header in requests.
    
- **Impact:**
    
    - Link theft.
        
    - SSRF.
        
    - Redirect reset links to attacker.
        
- **Testing:** Modify Host header:
    

```
Host: attacker.com
Host: victim.com
```

## 15. Origin & Referrer Manipulation

- **Description:** System trusts `Origin` or `Referrer`.
    
- **Impact:** Can steal reset link.
    
- **Testing:** Test headers:
    

```
Origin: hacker.com
Referrer: https://burpcollab.com/
```

## 16. IDOR via Reset

- **Description:** Email appears in reset request payload.
    
- **Impact:** Change email to victim â†’ account takeover.
    
- **Testing:** Replace email in JSON request:
    

```
{"email":"attacker@mail.com"} â†’ {"email":"victim@mail.com"}
```

## 17. Email Injection

- **Description:** Inject additional emails into the input.
    
- **Impact:** Attacker receives reset links as well.
    
- **Testing / Examples:**
    

```
{"email":"victim@mail.com,villain@mail.com"}
{"email":"victim@mail.com%0Abcc:attacker@mail.com"}
```

